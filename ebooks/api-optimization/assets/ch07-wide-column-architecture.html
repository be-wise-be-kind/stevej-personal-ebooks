<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wide-Column Database Architecture</title>
    <style>
        body {
            font-family: Liberation Sans, Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f8fafc;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .diagram-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            padding: 24px;
            max-width: 100%;
        }
        svg {
            display: block;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <div class="diagram-container">
        <svg viewBox="0 0 900 580" xmlns="http://www.w3.org/2000/svg">
            <!-- Background -->
            <rect width="900" height="580" fill="white"/>

            <!-- Title -->
            <text x="450" y="30" text-anchor="middle" style="font-size: 18px; font-weight: 600; fill: #1e293b;" font-family="Liberation Sans, Arial, sans-serif">Wide-Column Database: Data Organization</text>
            <text x="450" y="50" text-anchor="middle" style="font-size: 11px; fill: #64748b;" font-family="Liberation Sans, Arial, sans-serif">Partition key determines node placement; clustering key determines sort order within partition</text>

            <!-- Left side: Conceptual Model -->
            <text x="220" y="85" text-anchor="middle" style="font-size: 14px; font-weight: 600; fill: #1e293b;" font-family="Liberation Sans, Arial, sans-serif">Logical View: Sensor Data Table</text>

            <!-- Table header -->
            <rect x="40" y="100" width="120" height="30" fill="#ef4444" stroke="#b91c1c" stroke-width="1"/>
            <text x="100" y="120" text-anchor="middle" style="font-size: 10px; fill: white; font-weight: 600;" font-family="Liberation Sans, Arial, sans-serif">sensor_id (PK)</text>

            <rect x="160" y="100" width="120" height="30" fill="#f59e0b" stroke="#d97706" stroke-width="1"/>
            <text x="220" y="120" text-anchor="middle" style="font-size: 10px; fill: white; font-weight: 600;" font-family="Liberation Sans, Arial, sans-serif">timestamp (CK)</text>

            <rect x="280" y="100" width="80" height="30" fill="#64748b" stroke="#475569" stroke-width="1"/>
            <text x="320" y="120" text-anchor="middle" style="font-size: 10px; fill: white; font-weight: 600;" font-family="Liberation Sans, Arial, sans-serif">temp</text>

            <rect x="360" y="100" width="80" height="30" fill="#64748b" stroke="#475569" stroke-width="1"/>
            <text x="400" y="120" text-anchor="middle" style="font-size: 10px; fill: white; font-weight: 600;" font-family="Liberation Sans, Arial, sans-serif">humidity</text>

            <!-- Table rows -->
            <rect x="40" y="130" width="120" height="25" fill="#fee2e2" stroke="#fca5a5" stroke-width="1"/>
            <text x="100" y="147" text-anchor="middle" style="font-size: 9px; fill: #991b1b;" font-family="Liberation Sans, Arial, sans-serif">sensor-A</text>
            <rect x="160" y="130" width="120" height="25" fill="#fef3c7" stroke="#fcd34d" stroke-width="1"/>
            <text x="220" y="147" text-anchor="middle" style="font-size: 9px; fill: #92400e;" font-family="Liberation Sans, Arial, sans-serif">2024-01-01 00:00</text>
            <rect x="280" y="130" width="80" height="25" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1"/>
            <text x="320" y="147" text-anchor="middle" style="font-size: 9px; fill: #475569;" font-family="Liberation Sans, Arial, sans-serif">72.1</text>
            <rect x="360" y="130" width="80" height="25" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1"/>
            <text x="400" y="147" text-anchor="middle" style="font-size: 9px; fill: #475569;" font-family="Liberation Sans, Arial, sans-serif">45</text>

            <rect x="40" y="155" width="120" height="25" fill="#fee2e2" stroke="#fca5a5" stroke-width="1"/>
            <text x="100" y="172" text-anchor="middle" style="font-size: 9px; fill: #991b1b;" font-family="Liberation Sans, Arial, sans-serif">sensor-A</text>
            <rect x="160" y="155" width="120" height="25" fill="#fef3c7" stroke="#fcd34d" stroke-width="1"/>
            <text x="220" y="172" text-anchor="middle" style="font-size: 9px; fill: #92400e;" font-family="Liberation Sans, Arial, sans-serif">2024-01-01 00:05</text>
            <rect x="280" y="155" width="80" height="25" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1"/>
            <text x="320" y="172" text-anchor="middle" style="font-size: 9px; fill: #475569;" font-family="Liberation Sans, Arial, sans-serif">72.3</text>
            <rect x="360" y="155" width="80" height="25" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1"/>
            <text x="400" y="172" text-anchor="middle" style="font-size: 9px; fill: #475569;" font-family="Liberation Sans, Arial, sans-serif">44</text>

            <rect x="40" y="180" width="120" height="25" fill="#dbeafe" stroke="#93c5fd" stroke-width="1"/>
            <text x="100" y="197" text-anchor="middle" style="font-size: 9px; fill: #1e40af;" font-family="Liberation Sans, Arial, sans-serif">sensor-B</text>
            <rect x="160" y="180" width="120" height="25" fill="#fef3c7" stroke="#fcd34d" stroke-width="1"/>
            <text x="220" y="197" text-anchor="middle" style="font-size: 9px; fill: #92400e;" font-family="Liberation Sans, Arial, sans-serif">2024-01-01 00:00</text>
            <rect x="280" y="180" width="80" height="25" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1"/>
            <text x="320" y="197" text-anchor="middle" style="font-size: 9px; fill: #475569;" font-family="Liberation Sans, Arial, sans-serif">68.5</text>
            <rect x="360" y="180" width="80" height="25" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1"/>
            <text x="400" y="197" text-anchor="middle" style="font-size: 9px; fill: #475569;" font-family="Liberation Sans, Arial, sans-serif">52</text>

            <!-- Legend for table -->
            <rect x="60" y="220" width="12" height="12" fill="#ef4444" rx="2"/>
            <text x="78" y="230" style="font-size: 9px; fill: #64748b;" font-family="Liberation Sans, Arial, sans-serif">Partition Key (PK) - determines which node stores the data</text>
            <rect x="60" y="238" width="12" height="12" fill="#f59e0b" rx="2"/>
            <text x="78" y="248" style="font-size: 9px; fill: #64748b;" font-family="Liberation Sans, Arial, sans-serif">Clustering Key (CK) - determines sort order within partition</text>

            <!-- Right side: Physical Storage -->
            <text x="680" y="85" text-anchor="middle" style="font-size: 14px; font-weight: 600; fill: #1e293b;" font-family="Liberation Sans, Arial, sans-serif">Physical Storage: Partitions</text>

            <!-- Node 1 -->
            <rect x="500" y="100" width="180" height="130" fill="#fee2e2" rx="6" stroke="#ef4444" stroke-width="2"/>
            <text x="590" y="120" text-anchor="middle" style="font-size: 11px; fill: #991b1b; font-weight: 600;" font-family="Liberation Sans, Arial, sans-serif">Partition: sensor-A</text>
            <text x="590" y="135" text-anchor="middle" style="font-size: 9px; fill: #64748b;" font-family="Liberation Sans, Arial, sans-serif">Node 1 (hash(sensor-A) → Node 1)</text>

            <!-- Rows within partition (sorted by timestamp) -->
            <rect x="510" y="145" width="160" height="20" fill="white" rx="3" stroke="#fca5a5" stroke-width="1"/>
            <text x="520" y="159" style="font-size: 8px; fill: #475569;" font-family="Liberation Sans, Arial, sans-serif">00:00 → temp:72.1, humidity:45</text>

            <rect x="510" y="168" width="160" height="20" fill="white" rx="3" stroke="#fca5a5" stroke-width="1"/>
            <text x="520" y="182" style="font-size: 8px; fill: #475569;" font-family="Liberation Sans, Arial, sans-serif">00:05 → temp:72.3, humidity:44</text>

            <rect x="510" y="191" width="160" height="20" fill="white" rx="3" stroke="#fca5a5" stroke-width="1"/>
            <text x="520" y="205" style="font-size: 8px; fill: #475569;" font-family="Liberation Sans, Arial, sans-serif">00:10 → temp:72.5, humidity:43</text>

            <text x="590" y="225" text-anchor="middle" style="font-size: 8px; fill: #991b1b; font-style: italic;" font-family="Liberation Sans, Arial, sans-serif">Sorted by clustering key (timestamp)</text>

            <!-- Node 2 -->
            <rect x="700" y="100" width="180" height="130" fill="#dbeafe" rx="6" stroke="#3b82f6" stroke-width="2"/>
            <text x="790" y="120" text-anchor="middle" style="font-size: 11px; fill: #1e40af; font-weight: 600;" font-family="Liberation Sans, Arial, sans-serif">Partition: sensor-B</text>
            <text x="790" y="135" text-anchor="middle" style="font-size: 9px; fill: #64748b;" font-family="Liberation Sans, Arial, sans-serif">Node 2 (hash(sensor-B) → Node 2)</text>

            <rect x="710" y="145" width="160" height="20" fill="white" rx="3" stroke="#93c5fd" stroke-width="1"/>
            <text x="720" y="159" style="font-size: 8px; fill: #475569;" font-family="Liberation Sans, Arial, sans-serif">00:00 → temp:68.5, humidity:52</text>

            <rect x="710" y="168" width="160" height="20" fill="white" rx="3" stroke="#93c5fd" stroke-width="1"/>
            <text x="720" y="182" style="font-size: 8px; fill: #475569;" font-family="Liberation Sans, Arial, sans-serif">00:05 → temp:68.7, humidity:51</text>

            <rect x="710" y="191" width="160" height="20" fill="white" rx="3" stroke="#93c5fd" stroke-width="1"/>
            <text x="720" y="205" style="font-size: 8px; fill: #475569;" font-family="Liberation Sans, Arial, sans-serif">00:10 → temp:68.9, humidity:50</text>

            <text x="790" y="225" text-anchor="middle" style="font-size: 8px; fill: #1e40af; font-style: italic;" font-family="Liberation Sans, Arial, sans-serif">Sorted by clustering key (timestamp)</text>

            <!-- Arrow showing distribution -->
            <path d="M 440 165 L 490 135" stroke="#64748b" stroke-width="1.5" fill="none" marker-end="url(#arrowGray)"/>
            <path d="M 440 185 L 490 195" stroke="#64748b" stroke-width="1.5" fill="none" marker-end="url(#arrowGray)"/>

            <!-- Query patterns section -->
            <rect x="40" y="280" width="820" height="130" fill="#f0fdf4" rx="8" stroke="#22c55e" stroke-width="2"/>
            <text x="450" y="305" text-anchor="middle" style="font-size: 13px; fill: #166534; font-weight: 600;" font-family="Liberation Sans, Arial, sans-serif">Efficient Query Patterns</text>

            <!-- Good queries -->
            <rect x="55" y="320" width="250" height="75" fill="white" rx="4" stroke="#86efac" stroke-width="1"/>
            <text x="180" y="340" text-anchor="middle" style="font-size: 10px; fill: #166534; font-weight: 600;" font-family="Liberation Sans, Arial, sans-serif">Fast (single partition)</text>
            <text x="65" y="358" style="font-size: 9px; fill: #166534;" font-family="Liberation Sans, Arial, sans-serif">SELECT * FROM sensors</text>
            <text x="65" y="372" style="font-size: 9px; fill: #166534;" font-family="Liberation Sans, Arial, sans-serif">WHERE sensor_id = 'sensor-A'</text>
            <text x="65" y="386" style="font-size: 9px; fill: #166534;" font-family="Liberation Sans, Arial, sans-serif">AND timestamp > '2024-01-01'</text>

            <rect x="320" y="320" width="250" height="75" fill="white" rx="4" stroke="#86efac" stroke-width="1"/>
            <text x="445" y="340" text-anchor="middle" style="font-size: 10px; fill: #166534; font-weight: 600;" font-family="Liberation Sans, Arial, sans-serif">Fast (partition + range on CK)</text>
            <text x="330" y="358" style="font-size: 9px; fill: #166534;" font-family="Liberation Sans, Arial, sans-serif">SELECT * FROM sensors</text>
            <text x="330" y="372" style="font-size: 9px; fill: #166534;" font-family="Liberation Sans, Arial, sans-serif">WHERE sensor_id = 'sensor-A'</text>
            <text x="330" y="386" style="font-size: 9px; fill: #166534;" font-family="Liberation Sans, Arial, sans-serif">AND timestamp BETWEEN ... AND ...</text>

            <!-- Bad query -->
            <rect x="585" y="320" width="260" height="75" fill="white" rx="4" stroke="#fca5a5" stroke-width="1"/>
            <text x="715" y="340" text-anchor="middle" style="font-size: 10px; fill: #991b1b; font-weight: 600;" font-family="Liberation Sans, Arial, sans-serif">Slow (full cluster scan)</text>
            <text x="595" y="358" style="font-size: 9px; fill: #991b1b;" font-family="Liberation Sans, Arial, sans-serif">SELECT * FROM sensors</text>
            <text x="595" y="372" style="font-size: 9px; fill: #991b1b;" font-family="Liberation Sans, Arial, sans-serif">WHERE temp > 70</text>
            <text x="595" y="386" style="font-size: 9px; fill: #64748b;" font-family="Liberation Sans, Arial, sans-serif">No partition key = scan all nodes</text>

            <!-- Why this matters section -->
            <rect x="40" y="425" width="820" height="130" fill="#fef3c7" rx="8" stroke="#f59e0b" stroke-width="2"/>
            <text x="450" y="450" text-anchor="middle" style="font-size: 13px; fill: #92400e; font-weight: 600;" font-family="Liberation Sans, Arial, sans-serif">Why Wide-Column for High Write Throughput</text>

            <text x="60" y="475" style="font-size: 10px; fill: #92400e;" font-family="Liberation Sans, Arial, sans-serif">1. Writes are append-only within each partition (no read-before-write)</text>
            <text x="60" y="495" style="font-size: 10px; fill: #92400e;" font-family="Liberation Sans, Arial, sans-serif">2. Each partition lives on specific nodes — writes distributed across cluster</text>
            <text x="60" y="515" style="font-size: 10px; fill: #92400e;" font-family="Liberation Sans, Arial, sans-serif">3. No global ordering — eliminates coordination bottleneck</text>
            <text x="60" y="535" style="font-size: 10px; fill: #92400e;" font-family="Liberation Sans, Arial, sans-serif">4. Time-series data naturally partitions by entity (sensor, user, device)</text>

            <!-- Arrow marker -->
            <defs>
                <marker id="arrowGray" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                    <path d="M0,0 L0,6 L9,3 z" fill="#64748b"/>
                </marker>
            </defs>
        </svg>
    </div>
</body>
</html>
